# 14. 画像の可視化及び手術支援・インターベンションにおける画像活用


## 1. 導入：診断から治療へ - 医用画像の新たな役割

これまでの講義では、CTやMRIといった各モダリティの原理から、フィルタリング、セグメンテーション、AIによる解析まで、医用画像処理に関する様々な「点」の知識を学んできました。

本講義は、それらの知識を「線」で結び、**実際の臨床現場でどのように統合され、患者さんの治療に貢献しているか**を学ぶ集大成となります。

### 治療におけるパラダイムシフト

かつて医用画像は、主に**「診断」**のための静的な情報として用いられてきました。しかし現在、その役割は大きく変化しています。

> **Before:** 画像は**「診断 (Diagnosis)」**のための静的な情報
> **Now:** 画像は**「治療 (Therapy)」**をナビゲートする動的なツールへ

画像処理技術の進化により、私たちはより安全で、より低侵襲な治療を実現できるようになりました。本日は、その最前線で活用されている技術を見ていきましょう。

### 本日のキーワード

本講義を理解するための3つのキーワードです。

1.  **可視化 (Visualization):**
    *   CTやMRIで得られた2Dの断層画像を、3Dの立体像として「見える化」する技術。人間の目では直接見ることのできない体内の複雑な構造を直感的に把握します。

2.  **ナビゲーション (Navigation):**
    *   カーナビが目的地まで案内するように、術前に計画した情報を術中の患者さんの身体に正確に重ね合わせ、手術器具を安全かつ正確に目標まで導く技術。

3.  **インターベンション (Intervention):**
    *   「介在」「介入」を意味し、X線や超音波などの画像をリアルタイムに見ながら、カテーテルや針を用いて行う低侵襲治療のことです。

![パラダイムシフトの概念図](images/paradigm_shift.png)

---

## 2. 【術前】見えないものを見る、触れる - 3D可視化と手術シミュレーション

手術の成否は、術前の計画にかかっていると言っても過言ではありません。3D可視化技術は、術者が複雑な解剖構造を正確に把握し、最適な手術計画を立案するための強力な武器となります。

### 2.1. 3D画像再構成のアルゴリズムと可視化技術

`講義4`で学んだ3D再構成技術を、アルゴリズムの観点から深掘りします。入力データはCTやMRIで撮影された連続断層画像、すなわちボクセルデータです。

#### ① サーフェスレンダリング (Surface Rendering)

対象物の「表面」を抽出して描画する手法です。

*   **代表的なアルゴリズム:** **`Marching Cubes法`**
    1.  8つのボクセルで構成される立方体（Cube）を考えます。
    2.  各頂点の値（例: CT値）が、設定した閾値より大きいか小さいかを判定します。
    3.  その組み合わせパターン（2^8 = 256通り）に応じて、あらかじめ定義されたポリゴン（三角形のメッシュ）を立方体内に配置（Marching）します。
    4.  これを全ボクセル領域で繰り返すことで、対象物全体の表面を表現するポリゴンモデルが生成されます。

*   **特徴:**
    *   **長所:** 臓器の形状把握に優れ、データ量が比較的小さいため高速に描画できます。
    *   **短所:** 表面しか描画しないため、内部の構造がわかりません。閾値の設定一つで結果が大きく変わってしまいます。

*   **臨床応用:** 骨の3Dモデル作成、顔面骨の形状評価、3Dプリンタで出力するためのSTLデータ作成など。

![サーフェスレンダリングの概念図](images/surface_rendering.png)

#### ② ボリュームレンダリング (Volume Rendering)

ボクセルデータ全体を「塊」として扱い、半透明に描画する手法です。

*   **代表的なアルゴリズム:** **`レイキャスティング法 (Ray-Casting)`**
    1.  画面（スクリーン）の各画素から、視点とは反対方向に仮想的な光線（Ray）を飛ばします。
    2.  この光線がボクセルデータを通過する際に、各ボクセルの値（CT値など）と**伝達関数（Transfer Function）**に基づいて、色（Color）と不透明度（Opacity）を計算します。
    3.  光線に沿って色と不透明度を蓄積・合成していき、最終的な画素の色を決定します。

!!! note "伝達関数 (Transfer Function) とは？"
    ボクセルの値（入力）を、色と不透明度（出力）に変換するための関数（テーブル）です。どのCT値の組織を、どの色で、どのくらい透明/不透明に表示するかを定義します。この設定次第で、骨だけを強調したり、血管と臓器を同時に表示したりと、多彩な表現が可能になります。

*   **特徴:**
    *   **長所:** 内部構造や組織の重なり具合を直感的に表現できます。
    *   **短所:** 計算量が多く、描画に時間がかかる傾向があります。伝達関数の設定が職人技になりがちです。

![ボリュームレンダリングの概念図](images/volume_rendering.png)

#### その他の投影法 (ボリュームレンダリングの派生)

レイキャスティング法における色の合成方法を単純化することで、特定の目的を持った画像を生成できます。

*   **MIP (Maximum Intensity Projection):** 視線上で**最も高い**画素値を持つボクセルの値を採用します。造影された血管や石灰化、結石などの描出に非常に有効です。
*   **MinIP (Minimum Intensity Projection):** 視線上で**最も低い**画素値を持つボクセルの値を採用します。空気を含んだ気管・気管支や、低吸収値を示す胆管などの描出に用いられます。
*   **AIP (Average Intensity Projection):** 視線上の画素値の**平均値**を採用します。ノイズを低減する効果があり、全体の構造を滑らかに観察したい場合に用います。

![MIPとMinIPの比較画像](images/mip_minip.png)

### 2.2. 手術シミュレーションへの応用

こうして作成された3Dモデルは、仮想空間での手術リハーサルを可能にします。

*   **仮想肝切除:** 肝臓の3Dモデル上で腫瘍を含む領域を仮想的に切除し、切除後の残存肝容積を正確に計算します。これにより、術後の肝不全リスクを予測し、安全な切除範囲を決定できます。
*   **インプラントシミュレーション:** 整形外科領域で、人工関節や骨接合プレートなどのインプラントを3D骨モデルに重ね合わせ、最適なサイズや挿入角度を術前に検討します。

### 2.3. 3Dプリンタによる実物大臓器モデル

サーフェスレンダリングで作成したSTL形式のデータは、3Dプリンタで出力できます。術者が実物大の臓器モデルを手に取り、触れることで、画面上では得られない立体的な感覚を掴み、より複雑な手術のイメージトレーニングに役立てます。

---

## 3. 【術中】計画を現実に - イメージガイド下手術 (Image Guided Surgery)

術前の緻密な計画も、術中に現実の患者さんの身体に反映できなければ意味がありません。イメージガイド下手術（IGS）は、そのギャップを埋める技術です。

### 3.1. 手術ナビゲーションシステム

術前の画像情報を使って、術中の手術器具の位置をリアルタイムに表示するシステムです。「手術室のカーナビ」と考えると分かりやすいでしょう。

*   **キーテクノロジー:** **`画像登録 (Image Registration)`** (`講義11`の復習)
    *   術前画像（CT/MRI）の世界（**画像座標系**）と、手術中の患者さんの現実世界（**物理座標系**）を一致させるプロセスです。
    *   一般的には、患者さんの顔や体に複数のマーカーを貼り付け、その位置を3次元位置計測カメラで計測し、CT画像上の同じ点の位置と対応付けることで、座標系の変換行列を計算します。

*   **システムの構成要素:**
    *   **3次元位置計測装置:** 赤外線光を反射するマーカーを追跡する**光学式**や、磁場の変化を検知する**磁場式**があります。
    *   **マーカー:** 患者さんの身体や、手術器具（プローブ、ドリルなど）に取り付けます。
    *   **ワークステーション:** 術前画像を表示し、リアルタイムに計測される器具の位置を画像上に重畳表示します。

*   **臨床応用例:**
    *   **脳神経外科:** 腫瘍を摘出する際に、すぐそばにある運動野や言語野といった重要な機能領域を避けるために使用されます。
    *   **整形外科:** 人工股関節のカップを計画通りの正確な角度で設置したり、脊椎にスクリューを安全に挿入したりする際に活躍します。

![手術ナビゲーションシステムの模式図](images/igs_system.png)

### 3.2. リアルタイム性を高める術中イメージング

手術ナビゲーションは非常に強力ですが、弱点もあります。それは、手術操作によって臓器の位置がずれる（例：脳の**Brain Shift**）と、術前画像との間に誤差が生じることです。この問題を解決するのが、**術中に画像を取得する**アプローチです。

*   **術中CT / MRI (ハイブリッド手術室):**
    *   手術室内にCTやMRI装置が設置されており、手術の途中で撮影が可能です。
    *   腫瘍が完全に取り切れたかを確認したり、ナビゲーションのズレを補正したりと、治療の精度と安全性を飛躍的に向上させます。

*   **術中超音波:**
    *   手軽にリアルタイムの断層像が得られます。脳神経外科や肝臓外科で、腫瘍の境界を確認するために広く用いられています。近年では、ナビゲーションシステムと融合する技術も発展しています。

### 3.3. 未来の技術：AR/MRによる手術支援

AR（拡張現実）やMR（複合現実）技術は、手術支援の形をさらに進化させる可能性を秘めています。

*   **HoloLens**のようなヘッドマウントディスプレイを装着した術者には、現実の患者さんの身体の上に、術前に作成した3D臓器モデルがピッタリと重なって見えます。
*   これにより、術者はモニターに視線を移すことなく、術野から目を離さずに必要な情報を直接確認でき、より直感的で没入感の高い手術が期待されています。

![AR手術支援のイメージ図](images/ar_surgery.png)

---

## 4. 【治療】切らずに治す - 画像ガイド下インターベンション

インターベンション（IVR: Interventional Radiology）は、主にX線透視やCT、超音波といった画像ガイド下に、カテーテルや針を用いて病気を治療する、低侵襲治療の総称です。

### 4.1. 血管内治療 (IVR)

血管の中から病気にアプローチする治療法です。

*   **主役となる装置:** **`X線血管造影装置`** (`講義5`の復習)
*   **重要な支援技術:**
    *   **DSA (Digital Subtraction Angiography):** 造影剤を注入する前の画像（マスク画像）を、注入後の画像から引き算することで、邪魔な骨や組織を消去し、血管だけを鮮明に描出する技術。
    *   **ロードマップ機能:** DSAで得られた血管像を静止画として透視像に重ねて表示する機能。これにより、カテーテルを目的の血管まで安全に誘導できます。
    *   **Cone Beam CT:** Cアームを回転させながら撮影することで、術中にCTライクな3D画像を取得できます。複雑な血管の走行や動脈瘤の形状を多角的に評価するのに役立ちます。

*   **臨床応用例:**
    *   **脳動脈瘤コイル塞栓術:** 脳動脈にできた瘤（こぶ）に、カテーテルを通してプラチナ製の柔らかいコイルを詰めて破裂を防ぐ治療。
    *   **肝細胞癌に対するカテーテル治療 (TACE):** 癌を栄養している肝動脈までカテーテルを進め、そこから抗がん剤と塞栓物質を注入し、癌を兵糧攻めにする治療。

![ロードマップ機能のイメージ図](images/roadmap_ivr.png)

### 4.2. 非血管系インターベンション

血管以外のルートでアプローチする治療法です。

*   **CTガイド下:**
    *   CTで病変の位置を正確に確認しながら、体表から針を刺して組織を採取（生検）したり、腫瘍を熱で焼き固めるラジオ波焼灼療法（RFA）などを行います。呼吸による臓器の動きを考慮する必要があります。

*   **超音波ガイド下:**
    *   リアルタイムに針先と周囲の構造を確認できるため、安全な穿刺が可能です。甲状腺や乳腺の細胞診、神経ブロック、ドレナージなどで広く用いられます。

### 4.3. 最先端治療：MRガイド下集束超音波治療 (MRgFUS)

`講義7`のMRIと`講義8`の超音波の知識が融合した、究極の非侵襲治療の一つです。

*   **原理:**
    1.  **MRI**で治療標的（例：子宮筋腫、本態性振戦の原因となる脳の部位）を正確に特定します。
    2.  体外から強力な**超音波（HIFU: High Intensity Focused Ultrasound）**をその一点に集中させ、熱で組織を焼灼します。
    3.  治療中、MRIはリアルタイムで組織の温度を計測（温度マッピング）し、標的だけが適切に加熱されているかを監視します。

*   **特徴:** 体に全く傷をつけずに、体内深部の治療が可能です。

---

## 5. まとめと将来展望

### 本日の振り返り

本日は、診断目的であった医用画像が、治療の現場でどのように活用されているかを見てきました。

> **術前計画 (3D可視化) → 術中支援 (ナビゲーション) → 低侵襲治療 (インターベンション)**

この一連の治療プロセスは、これまで学んできた画像再構成、画像登録といった様々な医用画像処理技術によって、シームレスに支えられています。

### 将来展望

医用画像と治療の融合は、今後さらに加速していきます。

*   **AIのさらなる活用 (`講義12`の発展):**
    *   術前の3Dモデル作成の自動化、手術ナビゲーションにおけるズレの自動補正、術中の異常検知など、AIが人間の判断をリアルタイムで支援する時代が到来します。
    *   手術支援ロボットとAIナビゲーションが高度に連携し、より精密で安全な手技が実現されるでしょう。

*   **デジタルツイン (Digital Twin):**
    *   個人の医用画像、ゲノム情報、ライフログなどから、コンピュータ上にその人そっくりの仮想的な身体（デジタルツイン）を構築します。
    *   手術や投薬をまずデジタルツイン上でシミュレーションし、その人に最も効果的で副作用の少ない治療法を見つけ出す、究極の個別化医療（Precision Medicine）の実現が期待されています。
